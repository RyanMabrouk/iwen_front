!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ff341e87-ef7d-4dab-9e3e-18d1436b3d22",e._sentryDebugIdIdentifier="sentry-dbid-ff341e87-ef7d-4dab-9e3e-18d1436b3d22")}catch(e){}}(),(()=>{var e={};e.id=2569,e.ids=[2569],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},61212:e=>{"use strict";e.exports=require("async_hooks")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},27920:e=>{"use strict";e.exports=require("diagnostics_channel")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},96119:e=>{"use strict";e.exports=require("perf_hooks")},35816:e=>{"use strict";e.exports=require("process")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},17718:e=>{"use strict";e.exports=require("node:child_process")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},85690:e=>{"use strict";e.exports=require("node:inspector")},87503:e=>{"use strict";e.exports=require("node:net")},70612:e=>{"use strict";e.exports=require("node:os")},49411:e=>{"use strict";e.exports=require("node:path")},51747:e=>{"use strict";e.exports=require("node:readline")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},47261:e=>{"use strict";e.exports=require("node:util")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},86351:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(31403),a=r(39307),n=r.n(a),o=r(38723),i=r(92305),c=r(51877),u=r(82021);r(53001);let d=(0,r(41228).$)("e36547273da2d36983c2da1e3ace55f219bb6244");var l=r(70278);function p(){let[e,t]=(0,a.useState)(["","","","","",""]),{counter:r,setCounter:p}=(0,l.C)(),x=(0,o.useSearchParams)().get("email")??"",{mutate:f}=function(e){let{toast:t}=(0,c.useToast)();return(0,i.useMutation)({mutationFn:async()=>(0,u.Z)(e??""),onSuccess:()=>{t.success("(OTP) تمت إعادة إرسال كلمة المرور لمرة واحدة بنجاح")},onError:e=>{try{let r=JSON.parse(e.message);Array.isArray(r)?r.forEach(e=>{e&&"object"==typeof e&&"message"in e&&t.error(e.message)}):t.error(e.message)}catch(r){t.error(e.message)}}})}(x),{mutate:m}=function(e,t){let{toast:r}=(0,c.useToast)(),s=(0,o.useRouter)();return(0,i.useMutation)({mutationFn:async()=>d(e??"",t),onSuccess:()=>{r.success("تم التحقق من الرمز المميز بنجاح"),s.push("/change_password")},onError:e=>{try{let t=JSON.parse(e.message);Array.isArray(t)?t.forEach(e=>{e&&"object"==typeof e&&"message"in e&&r.error(e.message)}):r.error(e.message)}catch(t){r.error(e.message)}}})}(x,e.join("")),h=[(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null)],g=(r,s)=>{if(/^[0-9]?$/.test(s)){let a=[...e];a[r]=s,t(a),s&&r<5&&h[r+1].current?.focus()}},b=(t,r)=>{"Backspace"===r.key?!e[t]&&t>0&&h[t-1].current?.focus():"ArrowLeft"===r.key&&t>0?(r.preventDefault(),h[t-1].current?.focus()):"ArrowRight"===r.key&&t<5&&(r.preventDefault(),h[t+1].current?.focus())},y=e=>{e.preventDefault();let r=e.clipboardData.getData("text").slice(0,6).replace(/\D/g,"");6===r.length&&(t(r.split("").map(e=>e||"")),h[5].current?.focus())};return(0,s.jsxs)("div",{className:"flex flex-col items-end gap-3 max-md:gap-5 max-md:p-3","data-sentry-component":"Token","data-sentry-source-file":"Token.tsx",children:[s.jsx("h1",{className:"text-xl font-semibold max-md:text-base",children:"نسخ رمز التحقق للمواصلة"}),s.jsx("h1",{className:"text-right text-xl max-md:text-base",children:": أدخل العدد المكون من 6 أرقام الذي أرسلناه إلى عنوان بريدك الإلكتروني"}),s.jsx("div",{className:"flex w-full items-center justify-end gap-2 max-md:justify-between max-md:gap-1",children:e.map((e,t)=>(0,s.jsxs)(n().Fragment,{children:[t>0&&s.jsx("span",{className:"text-xl max-md:hidden",children:"-"}),s.jsx("input",{ref:h[t],value:e,onChange:e=>g(t,e.target.value),onKeyDown:e=>b(t,e),onPaste:y,maxLength:1,placeholder:"-",type:"text",inputMode:"numeric",pattern:"[0-9]*",className:`h-[5rem] w-[4rem] rounded-xl border text-center text-2xl text-teal-600 outline-none max-xl:h-[4rem] max-xl:w-[3rem] max-lg:h-[3rem] max-lg:w-[35px] ${e?"border-teal-600":"border-gray-300"}`})]},t))}),(0,s.jsxs)("p",{className:"flex items-center gap-2 max-md:mt-10",children:[s.jsx("button",{onClick:()=>{0===r&&(f(),p(60),localStorage.setItem("otpCooldownEnd",(Date.now()+6e4).toString()))},disabled:r>0,className:`cursor-pointer text-nowrap text-xl font-semibold max-lg:text-base ${r>0?"cursor-not-allowed opacity-50":""}`,children:r>0?`إعادة الإرسال (${r})`:"إعادة الإرسال الآن"}),s.jsx("span",{className:"text-nowrap",children:"لم تتلق الرمز ؟"})]})]})}var x=r(75632);function f(){return s.jsx(a.Suspense,{fallback:s.jsx(x.J5,{className:"m-auto",autoplay:!0,loop:!0,src:"/loading.json",style:{height:"12rem",width:"12rem"}}),"data-sentry-element":"Suspense","data-sentry-component":"page","data-sentry-source-file":"page.tsx",children:s.jsx(p,{"data-sentry-element":"Token","data-sentry-source-file":"page.tsx"})})}},87077:(e,t,r)=>{"use strict";let s;r.r(t),r.d(t,{default:()=>h,generateImageMetadata:()=>f,generateMetadata:()=>x,generateViewport:()=>m});var a=r(28920),n=r(68691),o=r(54637),i=r(54580),c=r(46167),u=r(81776);let d=(0,u.createProxy)(String.raw`/Users/macmini/Sites/iwan/iwen_front/src/provider/auth/CounterProvider.tsx#CounterProvider`);(0,u.createProxy)(String.raw`/Users/macmini/Sites/iwan/iwen_front/src/provider/auth/CounterProvider.tsx#useCounter`),r(9943);let l={...i},p="workUnitAsyncStorage"in l?l.workUnitAsyncStorage:"requestAsyncStorage"in l?l.requestAsyncStorage:void 0;s=new Proxy(function({children:e}){return(0,c.jsx)(d,{"data-sentry-element":"CounterProvider","data-sentry-component":"layout","data-sentry-source-file":"layout.tsx",children:e})},{apply:(e,t,r)=>{let s,i,c;try{let e=(0,a.x)([p,"optionalAccess",e=>e.getStore,"call",e=>e()]);s=(0,n.h)((0,a.x)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("sentry-trace")]),()=>void 0),i=(0,n.h)((0,a.x)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("baggage")]),()=>void 0),c=(0,a.x)([e,"optionalAccess",e=>e.headers])}catch(e){}return o.wrapServerComponentWithSentry(e,{componentRoute:"/(auth)/forget_password",componentType:"Layout",sentryTraceHeader:s,baggageHeader:i,headers:c}).apply(t,r)}});let x=void 0,f=void 0,m=void 0,h=s},47376:(e,t,r)=>{"use strict";let s;r.r(t),r.d(t,{default:()=>f,generateImageMetadata:()=>p,generateMetadata:()=>l,generateViewport:()=>x});var a=r(28920),n=r(68691),o=r(54637),i=r(54580),c=(0,r(81776).createProxy)(String.raw`/Users/macmini/Sites/iwan/iwen_front/src/app/(auth)/forget_password/token/page.tsx#default`);let u={...i},d="workUnitAsyncStorage"in u?u.workUnitAsyncStorage:"requestAsyncStorage"in u?u.requestAsyncStorage:void 0;s="function"==typeof c?new Proxy(c,{apply:(e,t,r)=>{let s,i,c;try{let e=(0,a.x)([d,"optionalAccess",e=>e.getStore,"call",e=>e()]);s=(0,n.h)((0,a.x)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("sentry-trace")]),()=>void 0),i=(0,n.h)((0,a.x)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("baggage")]),()=>void 0),c=(0,a.x)([e,"optionalAccess",e=>e.headers])}catch(e){}return o.wrapServerComponentWithSentry(e,{componentRoute:"/(auth)/forget_password/token",componentType:"Page",sentryTraceHeader:s,baggageHeader:i,headers:c}).apply(t,r)}}):c;let l=void 0,p=void 0,x=void 0,f=s},37550:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.Z,__next_app__:()=>l,originalPathname:()=>d,pages:()=>u,routeModule:()=>p,tree:()=>c}),r(47376),r(87077),r(74909),r(30464),r(33670),r(68397),r(34506),r(38064);var s=r(57007),a=r(25706),n=r(26657),o=r(62903),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let c=["",{children:["(auth)",{children:["forget_password",{children:["token",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,47376)),"/Users/macmini/Sites/iwan/iwen_front/src/app/(auth)/forget_password/token/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,87077)),"/Users/macmini/Sites/iwan/iwen_front/src/app/(auth)/forget_password/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,74909)),"/Users/macmini/Sites/iwan/iwen_front/src/app/(auth)/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,30464)),"/Users/macmini/Sites/iwan/iwen_front/src/app/(auth)/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,33670)),"/Users/macmini/Sites/iwan/iwen_front/src/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,68397)),"/Users/macmini/Sites/iwan/iwen_front/src/app/error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,34506)),"/Users/macmini/Sites/iwan/iwen_front/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,38064)),"/Users/macmini/Sites/iwan/iwen_front/src/app/not-found.tsx"]}],u=["/Users/macmini/Sites/iwan/iwen_front/src/app/(auth)/forget_password/token/page.tsx"],d="/(auth)/forget_password/token/page",l={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(auth)/forget_password/token/page",pathname:"/forget_password/token",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},15919:(e,t,r)=>{let s={ca46bb2487e9ee46055dae471e43218f96c9fd1f:()=>Promise.resolve().then(r.bind(r,75546)).then(e=>e.default),e36547273da2d36983c2da1e3ace55f219bb6244:()=>Promise.resolve().then(r.bind(r,22271)).then(e=>e.default),"42d1d7de5af24c0bb87cd8f1a49c3320d0dadbb1":()=>Promise.resolve().then(r.bind(r,94084)).then(e=>e.default),e161e4585ecdbe0402b5e00afdca5e5e6b7888b3:()=>Promise.resolve().then(r.bind(r,98878)).then(e=>e.default)};async function a(e,...t){return(await s[e]()).apply(null,t)}e.exports={ca46bb2487e9ee46055dae471e43218f96c9fd1f:a.bind(null,"ca46bb2487e9ee46055dae471e43218f96c9fd1f"),e36547273da2d36983c2da1e3ace55f219bb6244:a.bind(null,"e36547273da2d36983c2da1e3ace55f219bb6244"),"42d1d7de5af24c0bb87cd8f1a49c3320d0dadbb1":a.bind(null,"42d1d7de5af24c0bb87cd8f1a49c3320d0dadbb1"),e161e4585ecdbe0402b5e00afdca5e5e6b7888b3:a.bind(null,"e161e4585ecdbe0402b5e00afdca5e5e6b7888b3")}},66430:(e,t,r)=>{Promise.resolve().then(r.bind(r,86351))},6956:(e,t,r)=>{Promise.resolve().then(r.bind(r,70278))},70278:(e,t,r)=>{"use strict";r.d(t,{C:()=>i,CounterProvider:()=>o});var s=r(31403),a=r(39307);let n=(0,a.createContext)(void 0);function o({children:e}){let[t,r]=(0,a.useState)(60);return s.jsx(n.Provider,{value:{counter:t,setCounter:r},"data-sentry-element":"unknown","data-sentry-component":"CounterProvider","data-sentry-source-file":"CounterProvider.tsx",children:e})}function i(){let e=(0,a.useContext)(n);if(!e)throw Error("useCounter must be used within a PageProvider");return{counter:e.counter,setCounter:e.setCounter}}},82021:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o}),r(53001);let s=(0,r(41228).$)("ca46bb2487e9ee46055dae471e43218f96c9fd1f");var a=r(88997);let n=a.z.object({email:a.z.string().email("عنوان البريد الإلكتروني غير صالح")});async function o(e){let t=n.parse({email:e}),{error:r}=await s(t.email);if(r)throw Error(r);return{success:!0,message:""}}},75546:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(33098);r(16355);var a=r(15856),n=r(20747);let o=(0,a.e)();async function i(e){let{error:t}=await o.auth.signInWithOtp({email:e,options:{shouldCreateUser:!1}});return t?{error:"حدث خطأ ما، يرجى المحاولة مرة أخرى"}:{error:null}}(0,n.h)([i]),(0,s.j)("ca46bb2487e9ee46055dae471e43218f96c9fd1f",i)},22271:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(33098);r(16355);var a=r(15856);async function n(e,t){let r=(0,a.e)(),{data:{session:s},error:n}=await r.auth.verifyOtp({email:e,token:t,type:"email"});return n?{error:n}:(s&&await r.auth.setSession({access_token:s.access_token,refresh_token:s.refresh_token}),{error:null})}(0,r(20747).h)([n]),(0,s.j)("e36547273da2d36983c2da1e3ace55f219bb6244",n)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9918,1069,7494,8997,2049,315],()=>r(37550));module.exports=s})();
//# sourceMappingURL=page.js.map