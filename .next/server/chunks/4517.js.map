{"version":3,"file":"4517.js","mappings":"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","sources":["webpack://iwan-front/../../../src/icons/check.ts","webpack://iwan-front/../../../src/icons/camera.ts","webpack://iwan-front/../../../src/icons/loader-circle.ts","webpack://iwan-front/./node_modules/.pnpm/uuid@10.0.0/node_modules/uuid/dist/esm-node/native.js","webpack://iwan-front/./node_modules/.pnpm/uuid@10.0.0/node_modules/uuid/dist/esm-node/rng.js","webpack://iwan-front/./node_modules/.pnpm/uuid@10.0.0/node_modules/uuid/dist/esm-node/stringify.js","webpack://iwan-front/./node_modules/.pnpm/uuid@10.0.0/node_modules/uuid/dist/esm-node/v4.js","webpack://iwan-front/./src/app/(dashboard)/(profile)/ui/profilepic.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Check\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjAgNiA5IDE3bC01LTUiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/check\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Check = createLucideIcon('Check', [['path', { d: 'M20 6 9 17l-5-5', key: '1gmf2c' }]]);\n\nexport default Check;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Camera\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQuNSA0aC01TDcgN0g0YTIgMiAwIDAgMC0yIDJ2OWEyIDIgMCAwIDAgMiAyaDE2YTIgMiAwIDAgMCAyLTJWOWEyIDIgMCAwIDAtMi0yaC0zbC0yLjUtM3oiIC8+CiAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMyIgcj0iMyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/camera\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Camera = createLucideIcon('Camera', [\n  [\n    'path',\n    {\n      d: 'M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z',\n      key: '1tc9qg',\n    },\n  ],\n  ['circle', { cx: '12', cy: '13', r: '3', key: '1vg3eu' }],\n]);\n\nexport default Camera;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name LoaderCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTJhOSA5IDAgMSAxLTYuMjE5LTguNTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/loader-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LoaderCircle = createLucideIcon('LoaderCircle', [\n  ['path', { d: 'M21 12a9 9 0 1 1-6.219-8.56', key: '13zald' }],\n]);\n\nexport default LoaderCircle;\n","import crypto from 'node:crypto';\nexport default {\n  randomUUID: crypto.randomUUID\n};","import crypto from 'node:crypto';\nconst rnds8Pool = new Uint8Array(256); // # of random values to pre-allocate\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n  if (poolPtr > rnds8Pool.length - 16) {\n    crypto.randomFillSync(rnds8Pool);\n    poolPtr = 0;\n  }\n  return rnds8Pool.slice(poolPtr, poolPtr += 16);\n}","import validate from './validate.js';\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  //\n  // Note to future-self: No, you can't remove the `toLowerCase()` call.\n  // REF: https://github.com/uuidjs/uuid/pull/677#issuecomment-1757351351\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset);\n  // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n  return uuid;\n}\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    offset = offset || 0;\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n    return buf;\n  }\n  return unsafeStringify(rnds);\n}\nexport default v4;","\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport Image from \"next/image\";\nimport { Camera, Check, Loader2 } from \"lucide-react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { uploadFile } from \"@/api/uploadFile\";\nimport { useToast } from \"@/hooks/useToast\";\nimport getEndpoint from \"@/services/getEndpoint\";\nimport sendRequest from \"@/services/sendRequest\";\nimport { IUserPayload, IValidationErrors } from \"@/types\";\ninterface ProfilePictureUploadProps {\n  defaultProfilePic: string | null | undefined;\n}\nexport default function ProfilePictureUpload({\n  defaultProfilePic\n}: ProfilePictureUploadProps) {\n  const [preview, setPreview] = useState<string>(defaultProfilePic ?? \"/default_avatar.png\");\n  const [isNewImage, setIsNewImage] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const queryClient = useQueryClient();\n  const {\n    toast\n  } = useToast();\n  useEffect(() => {\n    setPreview(defaultProfilePic ?? \"/default_avatar.png\");\n  }, [defaultProfilePic]);\n  const updateAvatarMutation = useMutation({\n    mutationFn: async (file: File) => {\n      setIsSubmitting(true);\n      const url = getEndpoint({\n        resource: \"users\",\n        action: \"updateMe\"\n      });\n      try {\n        const formData = new FormData();\n        formData.append(\"filepicture\", file);\n        const image_url = await uploadFile({\n          formData,\n          name: \"filepicture\",\n          title: uuidv4()\n        });\n        const payload = {\n          avatar: image_url\n        };\n        const {\n          error,\n          validationErrors\n        } = await sendRequest<IUserPayload, IUserPayload>({\n          method: \"PATCH\",\n          url: url(),\n          payload: payload\n        });\n        if (error || validationErrors) {\n          throw new Error(\"فشل تحديث الصورة الشخصية\");\n        }\n        return image_url;\n      } finally {\n        setIsSubmitting(false);\n      }\n    },\n    onSuccess: newImageUrl => {\n      queryClient.invalidateQueries({\n        queryKey: [\"users\", \"me\"]\n      });\n      setPreview(newImageUrl);\n      setIsNewImage(false);\n      toast.success(\"تم تحديث الصورة الشخصية بنجاح.\");\n    },\n    onError: error => {\n      toast.error(`فشل تحديث الصورة الشخصية`);\n    }\n  });\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const objectUrl = URL.createObjectURL(file);\n      setPreview(objectUrl);\n      setIsNewImage(true);\n    }\n  };\n  const handleSubmit = () => {\n    if (!document) return;\n    const fileInput = document.querySelector<HTMLInputElement>(\"#profile-picture-upload\");\n    const file = fileInput?.files?.[0];\n    if (file) {\n      updateAvatarMutation.mutate(file);\n    }\n  };\n  return <div className=\"relative inline-block\" dir=\"rtl\" data-sentry-component=\"ProfilePictureUpload\" data-sentry-source-file=\"profilepic.tsx\">\n      <Image src={preview || \"/default_avatar.png\"} alt=\"\" width={500} height={500} className=\"h-full w-20 rounded-full sm:w-28 md:w-[9rem]\" data-sentry-element=\"Image\" data-sentry-source-file=\"profilepic.tsx\" />\n      <label htmlFor=\"profile-picture-upload\" className=\"absolute bottom-0 right-0 cursor-pointer rounded-full bg-white p-1 shadow-md\" title=\"تغيير الصورة الشخصية\">\n        <Camera className=\"h-4 w-4 text-gray-600\" data-sentry-element=\"Camera\" data-sentry-source-file=\"profilepic.tsx\" />\n      </label>\n      <input id=\"profile-picture-upload\" type=\"file\" accept=\"image/*\" onChange={handleImageChange} className=\"sr-only\" />\n      {isNewImage && !isSubmitting && <div className=\"absolute inset-0 flex cursor-pointer items-center justify-center rounded-full bg-black bg-opacity-50\" onClick={handleSubmit} title=\"حفظ الصورة الجديدة\">\n          <Check className=\"h-8 w-8 text-white\" />\n        </div>}\n      {isSubmitting && <div className=\"absolute inset-0 flex items-center justify-center rounded-full bg-black bg-opacity-50\">\n          <Loader2 className=\"h-6 w-6 animate-spin text-white\" />\n        </div>}\n    </div>;\n}"],"names":["Check","createLucideIcon","d","key","Camera","cx","cy","r","LoaderCircle","esm_node_native","randomUUID","rnds8Pool","Uint8Array","poolPtr","length","byteToHex","i","push","toString","slice","esm_node_v4","options","buf","offset","rnds","random","rng","external_node_crypto_default","randomFillSync","unsafeStringify","arr","toLowerCase","ProfilePictureUpload","defaultProfilePic","preview","setPreview","useState","isNewImage","setIsNewImage","isSubmitting","setIsSubmitting","queryClient","useQueryClient","toast","useToast","updateAvatarMutation","useMutation","mutationFn","file","url","getEndpoint","resource","action","formData","FormData","append","image_url","uploadFile","name","title","uuidv4","error","validationErrors","sendRequest","method","payload","avatar","onSuccess","newImageUrl","invalidateQueries","queryKey","success","onError","react_jsx_runtime","jsxs","div","className","dir","data-sentry-component","data-sentry-source-file","jsx","Image","src","alt","width","height","data-sentry-element","label","htmlFor","input","id","type","accept","onChange","e","target","files","URL","createObjectURL","onClick","document","fileInput","querySelector","mutate","Loader2"],"sourceRoot":""}